---
title: "MCP"
description: "MemMachine 的 MCP API 示例"
icon: "server"
---

# MCP API 示例
## Hello World：MemMachine MCP Server API 指南

本指南将通过 `curl` 命令快速带你了解 MemMachine 的 Model Content Protocol (MCP) Server API。同样内容可在我们的 [快速入门指南](https://memmachine.ai/docs/getting-started/quick-start-guide) 中找到。

### 前置条件

首先确保 FastAPI 应用已运行。在终端进入包含 `app.py` 的目录，执行以下命令并确认服务已开始监听请求。

```
uvicorn app:app --reload
```
<Steps>
<Step title="获取所有会话">

最简单的起点是查看当前会话。这是一个 MCP **resource**，会返回所有可用会话列表。

**命令：**

```
curl http://127.0.0.1:8080/mcp/sessions
```

**预期结果：**

若尚未创建会话，通常会看到空列表。
</Step>
<Step title="新增记忆片段">

这里我们使用 MCP **tool** 来创建第一条记忆片段。`mcp_add_session_memory` 通过 `POST` 请求调用。

**命令：**

```
curl -X POST "http://127.0.0.1:8080/mcp/add_session_memory" \
-H "Content-Type: application/json" \
-d '{
  "session": {
    "group_id": "test_group",
    "agent_id": ["test_agent"],
    "user_id": ["test_user"],
    "session_id": "session_123"
  },
  "producer": "test_user",
  "produced_for": "test_agent",
  "episode_content": "This is a simple test memory.",
  "episode_type": "message",
  "metadata": {}
}'
```

**预期结果：**

会返回一个 JSON 响应，`status` 为 `0` 表示成功。

```
{
  "status": 0,
  "error_msg": ""
}
```
</Step>
<Step title="检索记忆片段">

写入记忆后，使用 `mcp_search_session_memory` **tool** 来检索。

**命令：**

```
curl -X POST "http://127.0.0.1:8080/mcp/search_session_memory" \
-H "Content-Type: application/json" \
-d '{
  "session": {
    "group_id": "test_group",
    "agent_id": ["test_agent"],
    "user_id": ["test_user"],
    "session_id": "session_123"
  },
  "query": "simple test memory",
  "filter": {},
  "limit": 5
}'
```

**预期结果：**

你将看到 `200 OK` 响应，包含刚写入的记忆片段。
</Step>
<Step title="删除会话数据">

测试结束后，可使用 `mcp_delete_session_data` **tool** 清理数据，帮助数据库保持整洁。

**命令：**

```
curl -X POST "http://127.0.0.1:8080/mcp/delete_session_data" \
-H "Content-Type: application/json" \
-d '{
  "session": {
    "group_id": "test_group",
    "agent_id": ["test_agent"],
    "user_id": ["test_user"],
    "session_id": "session_123"
  }
}'
```

**预期结果：**

返回的 JSON 会确认删除状态，`status` 为 `0` 表示数据已成功移除。

```
{
  "status": 0,
  "error_msg": ""
}
```
</Step>
</Steps>